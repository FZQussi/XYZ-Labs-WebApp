

Estrutura BD.
printstore=# \dt
                   List of tables
 Schema |         Name          | Type  |   Owner
--------+-----------------------+-------+------------
 public | categories            | table | postgres
 public | colors                | table | postgres
 public | files                 | table | printstore
 public | materials             | table | postgres
 public | order_items           | table | postgres
 public | orders                | table | postgres
 public | password_reset_tokens | table | postgres
 public | product_materials     | table | postgres
 public | products              | table | printstore
 public | products_backup       | table | postgres
 public | subcategories         | table | postgres
 public | users                 | table | postgres
(12 rows)


printstore=# \d products
                                          Table "public.products"
     Column     |            Type             | Collation | Nullable |               Default
----------------+-----------------------------+-----------+----------+--------------------------------------
 id             | integer                     |           | not null | nextval('products_id_seq'::regclass)
 name           | character varying(255)      |           | not null |
 description    | text                        |           | not null |
 price          | numeric(10,2)               |           | not null |
 model_file     | character varying(255)      |           | not null |
 created_at     | timestamp without time zone |           |          | CURRENT_TIMESTAMP
 updated_at     | timestamp without time zone |           |          | CURRENT_TIMESTAMP
 subcategory_id | integer                     |           |          |
 slug           | character varying(255)      |           |          |
 is_active      | boolean                     |           |          | true
 category_id    | integer                     |           |          |
 images         | text[]                      |           |          |
 stock          | boolean                     |           | not null | false
Indexes:
    "products_pkey" PRIMARY KEY, btree (id)
    "idx_products_active" btree (is_active)
    "idx_products_category" btree (category_id)
    "idx_products_subcategory" btree (subcategory_id)
    "products_slug_key" UNIQUE CONSTRAINT, btree (slug)
Foreign-key constraints:
    "fk_products_category" FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE SET NULL
    "fk_products_subcategory" FOREIGN KEY (subcategory_id) REFERENCES subcategories(id) ON DELETE SET NULL
Referenced by:
    TABLE "order_items" CONSTRAINT "order_items_product_id_fkey" FOREIGN KEY (product_id) REFERENCES products(id) ON DELETE CASCADE
    TABLE "product_materials" CONSTRAINT "product_materials_product_id_fkey" FOREIGN KEY (product_id) REFERENCES products(id) ON DELE
TE CASCADE
Triggers:
    update_products_updated_at BEFORE UPDATE ON products FOR EACH ROW EXECUTE FUNCTION update_updated_at_column()


printstore=# \d categories
                                        Table "public.categories"
   Column   |            Type             | Collation | Nullable |                Default
------------+-----------------------------+-----------+----------+----------------------------------------
 id         | integer                     |           | not null | nextval('categories_id_seq'::regclass)
 name       | character varying(150)      |           | not null |
 created_at | timestamp without time zone |           |          | CURRENT_TIMESTAMP
Indexes:
    "categories_pkey" PRIMARY KEY, btree (id)
    "categories_name_key" UNIQUE CONSTRAINT, btree (name)
Referenced by:
    TABLE "products" CONSTRAINT "fk_products_category" FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE SET NULL
    TABLE "subcategories" CONSTRAINT "subcategories_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE C
ASCADE


printstore=# \d subcategories
                                         Table "public.subcategories"
   Column    |            Type             | Collation | Nullable |                  Default
-------------+-----------------------------+-----------+----------+-------------------------------------------
 id          | integer                     |           | not null | nextval('subcategories_id_seq'::regclass)
 category_id | integer                     |           | not null |
 name        | character varying(150)      |           | not null |
 created_at  | timestamp without time zone |           |          | CURRENT_TIMESTAMP
Indexes:
    "subcategories_pkey" PRIMARY KEY, btree (id)
    "subcategories_category_id_name_key" UNIQUE CONSTRAINT, btree (category_id, name)
Foreign-key constraints:
    "subcategories_category_id_fkey" FOREIGN KEY (category_id) REFERENCES categories(id) ON DELETE CASCADE
Referenced by:
    TABLE "products" CONSTRAINT "fk_products_subcategory" FOREIGN KEY (subcategory_id) REFERENCES subcategories(id) ON DELETE SET NUL
L

